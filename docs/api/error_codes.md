# API错误码说明

## 错误码格式
错误码由以下部分组成：
- 模块标识（2位）
- 错误类型（2位）
- 具体错误（2位）

例如：`010203` 表示 `认证模块(01)` 的 `参数错误(02)` 中的 `密码格式错误(03)`

## 模块标识
- 01: 认证模块
- 02: 知识库模块
- 03: AI服务模块
- 04: 备份模块
- 05: 系统模块

## 错误类型
- 01: 系统错误
- 02: 参数错误
- 03: 权限错误
- 04: 业务错误
- 05: 网络错误

## 具体错误码

### 认证模块 (01)
#### 系统错误 (0101)
- 010101: 数据库连接失败
- 010102: 缓存服务异常
- 010103: 内部服务错误

#### 参数错误 (0102)
- 010201: 缺少必要参数
- 010202: 用户名格式错误
- 010203: 密码格式错误
- 010204: 邮箱格式错误

#### 权限错误 (0103)
- 010301: 未登录
- 010302: 令牌过期
- 010303: 令牌无效
- 010304: 权限不足

#### 业务错误 (0104)
- 010401: 用户不存在
- 010402: 密码错误
- 010403: 账号已禁用
- 010404: 登录失败次数过多

### 知识库模块 (02)
#### 系统错误 (0201)
- 020101: 向量存储连接失败
- 020102: 数据库操作失败
- 020103: 内部服务错误

#### 参数错误 (0202)
- 020201: 缺少必要参数
- 020202: 文档格式错误
- 020203: 元数据格式错误
- 020204: 查询参数错误

#### 权限错误 (0203)
- 020301: 无访问权限
- 020302: 无操作权限
- 020303: 文档访问受限

#### 业务错误 (0204)
- 020401: 文档不存在
- 020402: 版本不存在
- 020403: 存储空间不足
- 020404: 文档重复

### AI服务模块 (03)
#### 系统错误 (0301)
- 030101: AI服务连接失败
- 030102: 模型加载失败
- 030103: 服务超时

#### 参数错误 (0302)
- 030201: 输入格式错误
- 030202: 参数范围错误
- 030203: 模型参数错误

#### 业务错误 (0304)
- 030401: 生成失败
- 030402: 内容审核未通过
- 030403: 配额超限
- 030404: 服务未启用

### 备份模块 (04)
#### 系统错误 (0401)
- 040101: 存储服务异常
- 040102: 数据库操作失败
- 040103: 内部服务错误

#### 参数错误 (0402)
- 040201: 备份类型错误
- 040202: 时间范围错误
- 040203: 元数据格式错误

#### 业务错误 (0404)
- 040401: 备份不存在
- 040402: 备份已存在
- 040403: 存储空间不足
- 040404: 备份未完成

### 系统模块 (05)
#### 系统错误 (0501)
- 050101: 服务启动失败
- 050102: 配置加载失败
- 050103: 资源分配失败

#### 业务错误 (0504)
- 050401: 系统维护中
- 050402: 服务降级
- 050403: 资源不足
- 050404: 操作频率限制

## 错误响应格式
```json
{
    "code": "010203",
    "message": "密码格式错误",
    "detail": {
        "min_length": 8,
        "max_length": 32,
        "require_special_char": true
    }
}
```

## 错误处理建议
1. 系统错误 (xx01)
   - 记录详细错误日志
   - 通知运维人员
   - 返回友好的错误提示

2. 参数错误 (xx02)
   - 返回具体的错误字段和原因
   - 提供正确的参数示例
   - 前端做好参数验证

3. 权限错误 (xx03)
   - 引导用户登录或获取权限
   - 清除无效的认证信息
   - 记录异常访问日志

4. 业务错误 (xx04)
   - 返回明确的错误原因
   - 提供解决方案建议
   - 必要时提供人工服务入口

5. 网络错误 (xx05)
   - 实现请求重试机制
   - 提供离线处理方案
   - 监控网络状态 

## 错误码规范
- 格式：AAABBBCC
  - AAA: 服务编号 (用户服务=100)
  - BBB: 模块编号 (认证模块=001)
  - CC: 具体错误码 (从01开始)

### 用户服务错误码
#### 认证模块 (100001)
- 10000101: 无效的访问令牌
- 10000102: 令牌已过期
- 10000103: 权限不足 